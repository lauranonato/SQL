#1 Retorne em uma só consulta os valores de média, máximo, mínimo, contagem e soma do campo ‘total_price’ da tabela items
select 
  avg(total_price) as media,
  max(total_price) as maximo,
  min(total_price) as minimo,
  count(total_price) as contagem
from e_commerce.items;

#2 Retorne a quantidade de pedidos de cada status por dia, ordenando pelo dia, de forma decrescente
select 
  count(id) as qtd_pedidos,
  status,
  date(created_at) as dia,
from e_commerce.orders
group by status, dia
order by dia desc;

#3 Retorne a quantidade total de itens por pedido
select count(i.id) as qtd_items, p.name as produto from e_commerce.items as i
join e_commerce.products as p
on i.product_id = p.id
group by produto;

##correto
select sum(i.quantity) as soma_pedidos, i.order_id as id_produto, p.name as nome
from e_commerce.items as i
join e_commerce.products as p
on i.product_id = p.id
group by nome;

#4 Na base de dados ‘covid19_italy’ e tabela ‘data_by_region’ encontre a coluna ‘tests_performed’. Retorne a soma de testes realizados por dia (considerando todas as regiões).

##5 DESAFIO: Retorne a diferença da soma de recuperados (coluna recovered) com a soma de mortes (coluna deaths) por dia, apenas para a região Toscana